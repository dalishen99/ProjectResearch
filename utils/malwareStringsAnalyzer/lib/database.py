import sqlite3
from datetime import datetime

class Database(object):
    def __init__(self, malware_path):
        self.conn = sqlite3.connect('./db/results.db')
        self.cursor = self.conn.cursor()
        self.malware_name = malware_path.split("/")[-3:]
        del self.malware_name[1]
        self.malware_name = "-".join(self.malware_name) + "_"
        self.malware_name += datetime.now().strftime("%d-%m-%y_%H:%M:%S")
        #print self.malware_name
        self.cursor.execute('''CREATE TABLE [{}] (string text, extract text
                            , type text)'''
            .format(self.malware_name))

    def createEntry(self, string, extract, type):
        req = """INSERT INTO [{}](string, extract, type)
                VALUES(?, ?, ?)""".format(self.malware_name)
        self.cursor.execute(req, (string, extract, type))
        self.conn.commit()

    def close(self):
        self.conn.close()
