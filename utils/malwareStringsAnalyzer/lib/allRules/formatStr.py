from lib.rules import Rules
from lib.parser import Parser

class FormatStr(Rules):
    def __init__(self):
        Rules.__init__(self)
        self.type = "format string"

    def run_analysis(self, string_list):
        print "-> Format string analysis is running"
        epur_string_list = []

        self.bar.init(string_list)
        for string in string_list:
            format_str_found = Parser.getFormatStr(string)
            if format_str_found != None:
                self.db.createEntry(string, format_str_found, self.type)
            else:
                epur_string_list.append(string)
            self.bar.update()
        self.bar.close()
        return epur_string_list
