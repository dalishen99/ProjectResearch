from lib.allRules.ipAddr import IpAddr
from lib.parser import Parser
from lib.database import Database
import os
import string

class Core(object):
    def __init__(self, malware_path):
        #print "core is init !"
        self.malware_path = malware_path
        self.db = Database(malware_path)
        self.string_list = None
        self.ipAddr = IpAddr()
        self.err_bad_path = "[Error] invalide malware file path."
        self.err_string_recovery = "[Error] string recovery failed."
        self.err_empty_bin = "[Error] no strings found."

    def load_strings(self):
        print "path: " + self.malware_path

        if not os.path.isfile(self.malware_path):
            print self.err_bad_path
            return False
        try:
            self.string_list = Parser.strings(self.malware_path)
        except:
            print self.err_string_recovery
            return False

        if self.string_list is None:
            print self.err_empty_bin
            return False

        return True

    def run(self):
        pass
        #print self.string_list
        #self.string_list, = self.ipAddr.run_analysis(self.string_list)
