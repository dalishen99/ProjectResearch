from lib.core import Core
import sys
import getopt

def usage():
    print """$> python msa.py [-p/--path=](PATH_OF_MALWARE_BIN) [-h/--help]"""

def getopts(argv):
    try:
        opts, args = getopt.getopt(argv, "hp:", ["help", "path="])
    except getopt.GetoptError:
        usage()
        sys.exit(2)
    return opts

if __name__ == '__main__':
    opts = getopts(sys.argv[1:])

    if opts == []:
        usage()
        sys.exit(2)

    for opt, arg in opts:
        if opt in ("-h", "--help"):
            usage()
            sys.exit()
        elif opt in ("-p", "--path"):
            core = Core(arg)
            if core.load_strings():
                core.run()
            else:
                sys.exit(2)
    print "\nBye !"
